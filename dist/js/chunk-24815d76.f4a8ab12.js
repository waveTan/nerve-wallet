(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-24815d76"],{2736:function(e,s,t){"use strict";t.r(s);var r=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"new_consensus bg-gray"},[t("div",{staticClass:"bg-white"},[t("div",{staticClass:"w1200"},[t("BackBar",{attrs:{backTitle:e.$t("nav.consensus")}}),t("h3",{staticClass:"title"},[e._v(e._s(e.$t("newConsensus.newConsensus0")))])],1)]),t("div",{staticClass:"w1200 bg-white mt_20"},[t("el-form",{ref:"createrForm",attrs:{model:e.createrForm,rules:e.createrRules}},[t("el-form-item",{attrs:{label:e.$t("public.createAddress")}},[t("el-input",{attrs:{disabled:""},model:{value:e.addressInfo.address,callback:function(s){e.$set(e.addressInfo,"address","string"===typeof s?s.trim():s)},expression:"addressInfo.address"}})],1),t("el-form-item",{attrs:{label:e.$t("public.rewardAddress"),prop:"rewardAddress"}},[t("el-input",{attrs:{maxlength:"50"},model:{value:e.createrForm.rewardAddress,callback:function(s){e.$set(e.createrForm,"rewardAddress","string"===typeof s?s.trim():s)},expression:"createrForm.rewardAddress"}})],1),t("el-form-item",{attrs:{label:e.$t("public.packingAddress"),prop:"blockAddress"}},[t("el-input",{attrs:{maxlength:"50"},model:{value:e.createrForm.blockAddress,callback:function(s){e.$set(e.createrForm,"blockAddress","string"===typeof s?s.trim():s)},expression:"createrForm.blockAddress"}})],1),t("el-form-item",{attrs:{label:e.$t("public.deposit")+"("+e.agentAsset.agentAsset.symbol+")",prop:"amount"}},[t("span",{staticClass:"balance font12 fr"},[e._v(e._s(e.$t("consensus.consensus2"))+": "+e._s(e.balanceInfo.balance/1e8))]),t("el-input",{model:{value:e.createrForm.amount,callback:function(s){e.$set(e.createrForm,"amount","string"===typeof s?s.trim():s)},expression:"createrForm.amount"}})],1),t("el-form-item",{attrs:{label:e.$t("public.commission")+"(%)",prop:"rate"}},[t("el-input",{model:{value:e.createrForm.rate,callback:function(s){e.$set(e.createrForm,"rate","string"===typeof s?s.trim():s)},expression:"createrForm.rate"}})],1),t("div",{staticClass:"font14"},[t("el-tooltip",{attrs:{placement:"top"}},[t("div",{attrs:{slot:"content"},slot:"content"},[e._v(e._s(e.$t("transfer.transfer5")))]),t("i",{staticClass:"el-icon-warning"})]),e._v("\n        "+e._s(e.$t("public.fee"))+": 0.001 "),t("span",{staticClass:"fCN"},[e._v(e._s(e.agentAsset.agentAsset.symbol))])],1),t("el-form-item",{staticClass:"form-next"},[t("el-button",{attrs:{type:"primary",disabled:e.isRed},on:{click:function(s){return e.submitForm("createrForm")}}},[e._v(e._s(e.$t("password.password3"))+"\n        ")])],1)],1)],1),t("Password",{ref:"password",on:{passwordSubmit:e.passSubmit}}),t("el-dialog",{staticClass:"confirm-dialog",attrs:{title:e.$t("newConsensus.newConsensus1"),visible:e.newConsensusVisible,width:"40rem"},on:{"update:visible":function(s){e.newConsensusVisible=s}}},[t("div",{staticClass:"bg-white"},[t("div",{staticClass:"div-data"},[t("p",[e._v(e._s(e.$t("public.createAddress"))+": ")]),t("label",[e._v(e._s(e.addressInfo.address))])]),t("div",{staticClass:"div-data"},[t("p",[e._v(e._s(e.$t("public.rewardAddress"))+": ")]),t("label",[e._v(e._s(e.createrForm.rewardAddress))])]),t("div",{staticClass:"div-data"},[t("p",[e._v(e._s(e.$t("public.packingAddress"))+": ")]),t("label",[e._v(e._s(e.createrForm.blockAddress))])]),t("div",{staticClass:"div-data"},[t("p",[e._v(e._s(e.$t("public.commission"))+": ")]),t("label",{staticClass:"yellow"},[e._v(e._s(e.createrForm.rate)+"% ")])]),t("div",{staticClass:"div-data"},[t("p",[e._v(e._s(e.$t("public.deposit"))+": ")]),t("label",{staticClass:"yellow"},[e._v(e._s(e.createrForm.amount)+" "),t("span",{staticClass:"fCN"},[e._v(e._s(e.agentAsset.agentAsset.symbol))])])]),t("div",{staticClass:"div-data"},[t("p",[e._v(e._s(e.$t("public.fee"))+": ")]),t("label",[e._v("0.001 "),t("span",{staticClass:"fCN"},[e._v(e._s(e.agentAsset.agentAsset.symbol))])])])]),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(s){e.newConsensusVisible=!1}}},[e._v(e._s(e.$t("password.password2")))]),t("el-button",{attrs:{type:"success"},on:{click:e.confiremSubmit}},[e._v(e._s(e.$t("transfer.transfer8")))])],1)])],1)},n=[],a=(t("6b54"),t("c5f6"),t("96cf"),t("3b8d")),i=t("0ad0"),o=t.n(i),c=t("1959"),d=t("6ace"),u=t("d1f0"),l=t("b301"),f={data:function(){var e=this,s=function(s,t,r){var n={};return t&&t.length>5&&(n=o.a.verifyAddress(t)),t?n.right?(e.$refs.createrForm.validateField("blockAddress"),void r()):r(new Error(e.$t("newConsensus.newConsensus21"))):r(new Error(e.$t("newConsensus.newConsensus2")))},t=function(s,t,r){var n={};return t&&t.length>5&&(n=o.a.verifyAddress(t)),t?t===e.addressInfo.address?r(new Error(e.$t("newConsensus.newConsensus4"))):n.right?void r():r(new Error(e.$t("newConsensus.newConsensus31"))):r(new Error(e.$t("newConsensus.newConsensus3")))},r=function(s,t,r){var n=/^\d+(?=\.{0,1}\d+$|$)/,a=/^\d{1,8}(\.\d{1,8})?$/,i=e.balanceInfo.balance-1e8*t;if(!t)return r(new Error(e.$t("newConsensus.newConsensus5")));n.exec(t)&&a.exec(t)?i<.001?r(new Error(e.$t("newConsensus.newConsensus7"))):t<2e4||t>2e5?r(new Error(e.$t("newConsensus.newConsensus8"))):r():r(new Error(e.$t("newConsensus.newConsensus6")))},n=function(s,t,r){var n=/^([1]?\d{1,2})$/;if(!t)return r(new Error(e.$t("newConsensus.newConsensus9")));n.exec(t)?t<10||t>100?r(new Error(e.$t("newConsensus.newConsensus11"))):r():r(new Error(e.$t("newConsensus.newConsensus10")))};return{addressInfo:{},balanceInfo:{},agentAsset:JSON.parse(sessionStorage.getItem("info")),isRed:!1,createrForm:{rewardAddress:"",blockAddress:"",amount:"",rate:""},createrRules:{rewardAddress:[{validator:s,trigger:["blur","change"]}],blockAddress:[{validator:t,trigger:["blur","change"]}],amount:[{validator:r,trigger:["blur","change"]}],rate:[{validator:n,trigger:["blur","change"]}]},newConsensusVisible:!1,prefix:"",getNewConsensusRandomString:"",sendNewConsensusRandomString:""}},created:function(){var e=this;Object(c["f"])(Object(d["f"])()).then((function(s){e.prefix=s})).catch((function(s){console.log(s),e.prefix=""})),this.addressInfo=Object(d["e"])(1),setInterval((function(){e.addressInfo=Object(d["e"])(1)}),500)},mounted:function(){var e=this;setTimeout((function(){e.getPunishByAddress(e.addressInfo.address),e.getBalanceByAddress(e.agentAsset.agentAsset.chainId,e.agentAsset.agentAsset.assetId,e.addressInfo.address)}),600)},watch:{addressInfo:function(e,s){e&&e.address!==s.address&&s.address&&(this.getPunishByAddress(this.addressInfo.address),this.getBalanceByAddress(this.agentAsset.agentAsset.chainId,this.agentAsset.agentAsset.assetId,this.addressInfo.address))}},components:{Password:u["a"],BackBar:l["a"]},methods:{submitForm:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(s){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.$refs[s].validate((function(e){if(!e)return!1;t.newConsensusVisible=!0}));case 1:case"end":return e.stop()}}),e,this)})));function s(s){return e.apply(this,arguments)}return s}(),getBalanceByAddress:function(e,s,t){var r=this;Object(c["e"])(e,s,t).then((function(e){e.success?r.balanceInfo=e.data:r.$message({message:r.$t("public.err2")+e,type:"error",duration:1e3})})).catch((function(e){r.$message({message:r.$t("public.err3")+e,type:"error",duration:1e3})}))},getPunishByAddress:function(e){var s=this;this.$post("/","getPunishList",[1,10,2,e]).then((function(e){0!==e.result.list.length?(s.isRed=!0,s.$message({message:s.$t("newConsensus.newConsensus12"),type:"error",duration:3e3})):s.isRed=!1})).catch((function(e){s.$message({message:s.$t("public.err3")+e,type:"error",duration:1e3})}))},confiremSubmit:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){var s,t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(""!==this.addressInfo.aesPri){e.next=22;break}return e.next=3,Object(d["m"])(16);case 3:return this.getNewConsensusRandomString=e.sent,e.next=6,Object(d["m"])(16);case 6:return this.sendNewConsensusRandomString=e.sent,e.next=9,this.newConsensusAssemble();case 9:if(s=e.sent,s.success){e.next=13;break}return this.$message({message:this.$t("tips.tips3"),type:"error",duration:3e3}),e.abrupt("return");case 13:return e.next=15,Object(c["b"])(this.getNewConsensusRandomString,this.sendNewConsensusRandomString,this.addressInfo.address,s.data);case 15:if(t=e.sent,t.success){e.next=19;break}return this.$message({message:this.$t("tips.tips4")+JSON.stringify(t.data),type:"error",duration:3e3}),e.abrupt("return");case 19:this.$refs.password.showScan(t.data.txInfo,t.data.assembleHex),e.next=23;break;case 22:this.$refs.password.showPassword(!0);case 23:case"end":return e.stop()}}),e,this)})));function s(){return e.apply(this,arguments)}return s}(),passSubmit:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(s){var t,r,n,a,i=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.newConsensusAssemble();case 2:if(t=e.sent,t.success){e.next=5;break}return e.abrupt("return");case 5:if(r=o.a.decrypteOfAES(this.addressInfo.aesPri,s),n=o.a.importByKey(this.addressInfo.chainId,r,s,this.prefix),n.address!==this.addressInfo.address){e.next=15;break}return e.next=10,o.a.transactionSerialize(r,this.addressInfo.pub,t.data);case 10:return a=e.sent,e.next=13,Object(c["i"])(a).then((function(e){e.success?i.$router.push({name:"txList"}):i.$message({message:i.$t("error."+e.data.code),type:"error",duration:3e3})})).catch((function(e){i.$message({message:i.$t("public.err0")+e,type:"error",duration:1e3})}));case 13:e.next=16;break;case 15:this.$message({message:this.$t("address.address13"),type:"error",duration:1e3});case 16:case"end":return e.stop()}}),e,this)})));function s(s){return e.apply(this,arguments)}return s}(),newConsensusAssemble:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){var s,t,r,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return s={fromAddress:this.addressInfo.address,assetsChainId:this.agentAsset.agentAsset.chainId,assetsId:this.agentAsset.agentAsset.assetId,amount:Number(Object(d["d"])(this.createrForm.amount,1e8).toString()),fee:1e5},e.next=3,Object(c["h"])(s,this.balanceInfo,4);case 3:if(t=e.sent,t.success){e.next=7;break}return this.$message({message:this.$t("public.err1")+JSON.stringify(t.data),type:"error",duration:3e3}),e.abrupt("return",{success:!1});case 7:return r={agentAddress:this.addressInfo.address,packingAddress:this.createrForm.blockAddress,rewardAddress:this.createrForm.rewardAddress,commissionRate:Number(this.createrForm.rate),deposit:Number(Object(d["d"])(this.createrForm.amount,1e8).toString())},e.next=10,o.a.transactionAssemble(t.data.inputs,t.data.outputs,"",4,r);case 10:return n=e.sent,console.log(n),e.abrupt("return",{success:!0,data:n});case 13:case"end":return e.stop()}}),e,this)})));function s(){return e.apply(this,arguments)}return s}()}},m=f,b=(t("b83f"),t("2877")),p=Object(b["a"])(m,r,n,!1,null,null,null);s["default"]=p.exports},"2e64":function(e,s,t){"use strict";var r=t("ff03"),n=t.n(r);n.a},a464:function(e,s,t){},b301:function(e,s,t){"use strict";var r=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"back",attrs:{backUrl:e.backUrl}},[t("span",{staticClass:"back-box",on:{click:e.back}},[t("i",{staticClass:"el-icon-arrow-left"}),t("span",[e._v(e._s(e.backTitle))])])])},n=[],a={props:{backTitle:{type:String,default:""},backUrl:{type:String,default:"1"},backParams:{type:String,default:""}},methods:{back:function(){"1"===this.backUrl?this.$router.go(-1):this.$router.push({name:this.backUrl})}}},i=a,o=(t("2e64"),t("2877")),c=Object(o["a"])(i,r,n,!1,null,null,null);s["a"]=c.exports},b83f:function(e,s,t){"use strict";var r=t("a464"),n=t.n(r);n.a},ff03:function(e,s,t){}}]);
//# sourceMappingURL=chunk-24815d76.f4a8ab12.js.map